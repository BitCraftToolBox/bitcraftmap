<!DOCTYPE html>
<html>
	<head>
		<title>Bitcraft Game Map</title>
    <link rel="icon" type="image/x-icon" href="assets/icons/MapCompass.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>

		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script src="https://rawgit.com/kawanet/msgpack-lite/master/dist/msgpack.min.js" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-canvas-marker@0.2.0/dist/leaflet.canvas-markers.min.js" crossorigin=""></script>


		<style>
      html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
      }
			#map {
				height: 100vh;
				width: 100%;
        background-color: #222d44;
			}
    </style>
	</head>

	<body>
    <div id="map"></div>

    <script>
      const tileSize = 256 // L.point(1860, 1812);

      const ChunkLayer = L.GridLayer.extend({
        createTile: function (coords) {

          const tile = document.createElement('img');

          tile.width = this.getTileSize().x;
          tile.height = this.getTileSize().y;

          console.log('Doing : ' + coords.y + ' ' + coords.x)

          const chunkX = 239 - coords.y;
          const chunkY = coords.x;

          
          console.log('Doing : ' + chunkX + ' ' + chunkY)

          tile.src = `assets/maps/chunks/all/chunk_${chunkY}_${chunkX}.png`;

          tile.onerror = function () {
            tile.src = 'placeholder.png';
          };

          return tile;
        }
      });

      const map = L.map('map', {
        crs: L.CRS.Simple,
        minZoom: 0,
        maxZoom: 0,
        maxNativeZoom: 0,
        zoom: 0,
        center: [0, 0],
        bounds: [[0, 0], [80, 80]], 
      });
      

      const layer = new ChunkLayer(
        { tileSize: tileSize }
        
      );
      layer.addTo(map);
    </script>
	</body>
</html>
